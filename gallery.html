<html>
<head>
	<link href="css/main.css" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script src="js/main.js"></script>
</head>
<body>
	<br>
	<h1>Gallery</h1>
	<h4>
		Some images from projects I've worked on and renders I've created.
		<br>
		Click an image to see a bigger version and use your arrow keys to go between images.
	</h4>

	<div id="portfolio-container">
	</div>

	<div id="overlay-main" class="overlay overlay-transparent">
	</div>
	<div id="overlay-controls" class="overlay">
		<img id="close" src="images/icons/cross.svg">
		<img id="right" class="vertically-centered arrow" src="images/icons/chevron-thin-right.svg">
		<img id="left" class="vertically-centered arrow" src="images/icons/chevron-thin-left.svg">
	</div>

	<script>
		var currentID = -1;

		var gallery = [
			{
				url: "images/InClouds1-min.png",
				title: "In Clouds",
				description: "In Clouds was the first game I released, and was one month game project."
			},
			{
				url: "images/InClouds2-min.png",
				title: "In Clouds",
				description: "In Clouds was the first game I released, and was one month game project."
			},
			{
				url: "images/Awakening.png",
				title: "Awakening",
				description: "My most complicated art piece in Blender, \"Awakening\" was presented in an exhibition at my school"
			},
			/*
			{
				url: "images/prototypeGame.png",
				title: "In Clouds",
				description: "Lorem ipsum dolor sit amet"
			}, */
			{
				url: "images/Lightbulb3.png",
				title: "Lightbulbs I",
				description: "Part of a set of three, this lightbulb was one of the results of my experiments with Blenders Cycles renderer."
			},
			{
				url: "images/Lightbulb4.png",
				title: "Lightbulbs II",
				description: "Part of a set of three, this lightbulb was one of the results of my experiments with Blenders Cycles renderer."
			},
			{
				url: "images/Lightbulb5.png",
				title: "Lightbulbs III",
				description: "Part of a set of three, this lightbulb was one of the results of my experiments with Blenders Cycles renderer."
			},
			{
				url: "images/sparks.jpg",
				title: "Sparks",
				description: "An experiment using advanced particle effects, motion blur, and depth of field in Blender."
			},
			{
				url: "images/TSOT1-min.png",
				title: "The Speed of Time",
				description: "The Speed of Time was a game I developed for a few years while learning Unity, but ended up suspending."
			},
			{
				url: "images/TSOT2-min.png",
				title: "The Speed of Time",
				description: "The Speed of Time was a game I developed for a few years while learning Unity, but ended up suspending."
			},
			{
				url: "images/TSOT3-min.png",
				title: "The Speed of Time",
				description: "The Speed of Time was a game I developed for a few years while learning Unity, but ended up suspending."
			},
			{
				url: "images/grassPlanet.jpg",
				title: "Grass Planet",
				description: "One of my first experiments with Blender, this piece uses particle effects to create a grass covered \"planet\""
			},
			{
				url: "images/chicagoSubwayEntrance.png",
				title: "Chicago Subway Entrance",
				description: "Using reference photos I took in downtown Chicago, I modelled this iconic Chicago subway entrance"
			},
		];

		var galleryInstance = new Gallery(gallery, {showInfo: true});

		// Generate all the portfolio tiles
		gallery.forEach(function(item, index)
		{
			$("#portfolio-container").append(
				'<div class="portfolio-img">' +
					'<div class="icon fullscreen"></div>' +
					'<img data-id="' + index + '" src=' + item.url + '>' +
				'</div>');
		});

		// On click of portfolio image
		$(".portfolio-img").click(function()
		{
			var image = $(this).find("img");
			galleryInstance.showImage(image.attr("data-id"));
		});

		$("#overlay-main, #overlay-controls #close").click(galleryInstance.close)
		$("#overlay-controls #right").click(galleryInstance.nextImage);
		$("#overlay-controls #left").click(galleryInstance.previousImage);

	$("body").keydown(function(event)
	{
	  if(event.keyCode == 37) //left arrow
	  {
	  	galleryInstance.previousImage();
	  }
	  else if(event.keyCode == 39) //right arrow
	  {
	  	galleryInstance.nextImage();
	  }
	  else if(event.keyCode == 27) //escape
	  {
	  	if($("#overlay-info:visible").length > 0)
	  		closeInfo();
	  	else
	  		galleryInstance.close();
	  }
	});

	// instantiates a gallery given a gallery data object, which contains info about all images to display
	// this can be either an array of hashes if you want more information in each gallery item
	// or an array of strings if you just need to display images
	// Possible options
	//	showInfo {Boolean} - whether to show a small info icon on the bottom left. DEFAULT - false
	function Gallery(galleryData, options)
	{
		this.galleryData = galleryData; //the gallery data
		this.currentImageIndex; //the index of the image being displayed in the gallery data
		self = this; // we need a scoped version of the gallery object for reference in functions

		// Show the image with the given index in the galleryData
		this.showImage = function(index)
		{
			self.currentImageIndex = index;
			setOverlayImage(getImageUrl(this.galleryData[index])); //set the image
			$(".overlay").fadeIn(); //then fade in
		}

		// Go to the next image
		this.nextImage = function()
		{
			if($("#overlay-info:visible").length > 0) //if info is showing up
				return; //don't do anything

			if(self.currentImageIndex < self.galleryData.length - 1) // if we aren't on the last item in the gallery
		  		self.currentImageIndex++; //go to next
		  	else //otherwise, loop back to the first
		  		self.currentImageIndex = 0;

		  	self.showImage(self.currentImageIndex);
		}
		this.previousImage = function()
		{
			if($("#overlay-info:visible").length > 0) //if info is showing up
				return;

			if(self.currentImageIndex > 0)
		  		self.currentImageIndex--;
		  	else
		  		self.currentImageIndex = self.galleryData.length - 1;

		  	self.showImage(self.currentImageIndex);
		}

		// closes the gallery with a nice animation
		this.close = function()
		{
			$(".overlay").fadeOut();
		}

		/*****************************/
		/****** PRIVATE METHODS ******/
		/*****************************/

		function setOverlayImage(url)
		{
			if($("#overlay-main:visible").length > 0 && $("#overlay-main img").length > 0) //if there's already an image
			{
				$("#overlay-main .img-container").fadeOut(300, function() //fade it out
				{
					//then transition to new image by setting it, hiding it instantly, then fadin in
					setOverlayHTMLWithImage(url);
				  	$("#overlay-main .img-container").hide().fadeIn(300);
				});
			}
			else
			{
				setOverlayHTMLWithImage(url);
			}

			function setOverlayHTMLWithImage(url)
			{
			  	$("#overlay-main").html(
			  	'<div class="img-base centered">' +
			  		'<div class="img-container">' +
				  		'<img src="' + url + '">' +
				  		'<div class="icon info"></div>' +
			  		'</div>' +
			  	'</div>');

			  	$("#overlay-main .img-container").click(function(event)
			  	{
			  		event.stopPropagation();
			  	});

			  	$("#overlay-main .img-container .icon.info").click(function()
			  	{
			  		showInfo(gallery[currentID].title, gallery[currentID].description)
			  	});
			}
		}

		/*
		 * Returns the image url from a given gallery item. This is needed as gallery items
		 * may be Javascript objects with a URL field, or just straight string URLs.
		 * @param {Object/string} galleryItem - The gallery item we want to get the URL of
		 * @return {string}	- The URL of the gallery item passed in
		 */
		function getImageUrl(galleryItem)
		{
			if (typeof galleryItem == "object")
				return galleryItem.url;
			else if (typeof galleryItem == "string")
				return galleryItem
			else
			{
				console.error("")
				return null;
			}
		}
	}
	</script>
</body>
</html>